{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roblox Intake Form</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="{% static 'css/style.css' %}" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <meta name="csrf-token" content="{{ csrf_token }}">
</head>

    <body>
          <!-- <nav class="navbar">
        <div class="nav-content">
            <a href="#" class="logo px-4">Logo Here</a>
            <div class="nav-links">
                <a href="#about">About</a>
                <a href="#cases">Cases</a>
                <a href="#resources">Resources</a>
                <a href="#contact">Contact</a>
            </div>
        </div>
    </nav> -->

<section class="hero">
      
        <a href="" class="logo  d-flex justify-content-left">
            <img src="{% static 'img/theme.svg' %}" alt="Logo" style="width: 260px; height: auto;">
        </a>
        <div class="hero-content">
              

            <h1>Roblox & Adult Predators: A Must-Know Warning</h1>
            <div class="separator"></div>
            <!-- <p>Roblox, the world's largest user-generated gaming platform "designed for children," attracts 78 million daily visitors</p> -->

            <div class="sub-heading"> Has your child had a troubling encounter with an adult on Roblox? If yes, we’re here to help. Just follow 3 simple steps:</div>
           
            <div class="step-wrapper">
                <div class="steps">
                    <div class="step-icon">
                        <img src="{% static 'img/icon-prequalify.svg' %}" alt="Prequalify">
                    </div>
                    <small class="pt-2 pb-1">Step 1</small>
                    <h4>Prequalify</h4>
                    <p>Briefly explain what happened during the troubling Roblox encounter.</p>
                </div>
                <div class="steps">
                    <div class="step-icon">
                        <img src="../static/img/icon-retainer.svg" alt="Prequalify">
                    </div>
                    <small class="pt-2 pb-1">Step 2</small>
                    <h4>Retainer</h4>
                    <p>We’ll provide a simple agreement so we can move forward.</p>
                </div>
                <div class="steps">
                    <div class="step-icon">
                        <img src="../static/img/icon-intake.svg" alt="Prequalify">
                    </div>
                    <small class="pt-2 pb-1">Step 3</small>
                    <h4>Intake</h4>
                    <p>Complete a quick intake form to understand how we can best help.</p>
                </div>
                
            </div>
            <div class="row mt-4">
                <div class=" d-flex justify-content-center">
                    <!-- <button class="btn px-5 mx-3" id="openModal" >Yes</button> -->
                    <button class="home-btn" id="openModal" >Yes, I need help</button>
                    <!-- <a href="{% url 'index-form-page' %}" class="btn px-5 mx-3">No</a> -->
                    <a href="{% url 'index-form-page' %}" class="home-btn">No, all good</a>
                </div>
            </div>

        </div>
    </section>

    <main class="main-content">
        <div class="content-grid">
            <div class="content-card">
                <div class="card-icon"><img src="{% static 'img/icon-expertise1.svg' %}" alt="Case Evaluation"></div>
                <div>
                    <h3>Class Action Expertise</h3>
                    <p>Specialized representation for group litigation matters, ensuring collective justice and fair compensation.</p>
                </div>
            </div>
            <div class="content-card">
                <div class="card-icon"><img src="{% static 'img/icon-expertise2.svg' %}" alt="Case Evaluation"></div>
                <div>
                    <h3>Case Evaluation</h3>
                    <p>Thorough analysis of legal claims to determine optimal strategies for successful resolution.</p>
                </div>
            </div>
            <div class="content-card">
                <div class="card-icon"><img src="{% static 'img/icon-expertise3.svg' %}" alt="Case Evaluation"></div>
                <div>
                    <h3>Client Advocacy</h3>
                    <p>Dedicated protection of client interests through aggressive litigation and negotiation tactics.</p>
                </div>
            </div>
        </div>
    </main>
    <div class="section-content primary-color">
        <div class="row px-4 py-5">
            <div class="col-12 col-md-4 text-center pb-4 pb-md-0">
                <!-- <img src="{% static 'img/Roblox-sec1.png' %}" alt="Roblox Image"> -->
                <img src="{% static 'img/Roblox-sec1.png' %}" alt="Roblox Image">
            </div>
            <div class="col-12 col-md-8 d-flex flex-column justify-content-center">
                <h4>  Is Roblox Putting Children at Risk of Predators? </h4>
                <p>Many parents trust Roblox to be a safe gaming platform for their children, but mounting lawsuits suggest otherwise. Despite promising child protection, Roblox faces serious allegations of failing to stop predators from targeting kids on its platform.</p>
                <h4>What You Should Know</h4>
                <ul>
                    <li>In 2023, Roblox reported 13,000+ sextortion cases to child safety authorities.</li>
                    <li>In early 2024, law enforcement requests jumped 33% - predators are still active.</li>
                    <li>Chat features, avatars, and hidden games are being used to manipulate children.</li>
                    <li>Kids as young as six have encountered virtual strip clubs and explicit content.</li>
                    <li>Lawsuits allege Roblox is not doing enough to monitor or block bad actors.</li>
                    <li>Many parents believe it’s a safe space - but harmful content continues to slip through.</li>
                </ul>
                <h4>This isn’t just a game - it’s a serious risk to children’s safety.</h4>
      
            </div>
</div>
    </div>
    <div class="section-safeguard secondary-color1">
        <div class="row px-4 py-5">
             
        <div class="col-12 col-md-8 bg-light-opacity d-flex flex-column justify-content-center">
            <h4>Doesn’t Roblox Have Safeguards in Place?</h4>
            <p>Roblox says it uses AI filters and 3,000 human moderators to monitor up to 50,000 private chats per second - all to keep kids safe.</p>
            <h4>But Critics Say These Protections Are Failing</h4>
            <ul>
                <li>Independent researcher Ben Simon (aka Ruben Sim) has exposed major moderation flaws.</li>
                <li>Harmless messages get flagged, while predatory chats go unchecked.</li>
                <li>TikTok, with 3x Roblox’s users, employs 40,000 moderators — 10x more than Roblox.</li>
                <li>Roblox, critics argue, spends more effort marketing safety than ensuring it.</li>
            </ul>
            <p class="text-italic mb-0"> “Roblox puts more time into convincing parents their platform is safe than actually protecting children.”</p>
            <p><span class="bold">- Ben Simon</span>  |  <span class="small"> who urged Roblox to ban a convicted pedophile </span></p>
            <h4>Roblox’s moderation may not be enough - and your child may not be as safe as you think.</h4>
            
                </div>    
                 <div class=" col-12 col-md-4 text-center ">
                    <!-- <img src="{% static 'img/Roblox-md-3.jpeg' %} alt="Roblox Safeguards Image"> -->
                    <img src="{% static 'img/Roblox-md-3.jpeg' %}" alt="Roblox Safeguards Image">
                 </div>    
</div>
    </div>

    <div class="section-Lawsuit py-5">
        <div class="row px-4 py-5 ">
            <div class="col-12">
                <h4>What Is the Roblox Sexual Abuse Lawsuit About?</h4>
                <p>Parents across the U.S. are filing lawsuits against Roblox, accusing the company of failing to protect children from sexual exploitation and financial abuse. These legal actions argue that the platform’s safeguards are inadequate, and children are paying the price.</p>
                <div class=" d-flex justify-content-between">
                    <div class=" lawsuit-box">
                        <h4>Key Allegations</h4>
                        <ul>
                            <li>Lawsuit filed in Oct 2022</li>
                            <li>Class-action claims Roblox exploits kids</li>
                            <li>Weak controls enable adult content, grooming, and overspending</li>
                        </ul>
                    </div>
                    <div class=" lawsuit-box">
                        <h4>Why It Matters</h4>
                        <ul>
                            <li>Shows systemic failure in safety</li>
                            <li>Trusted platform exposing children</li>
                            <li>Parents unaware of real dangers</li>
                        </ul>
                    </div>
                </div>
            </div>
            <!-- <div class="col-12 col-md-6 text-center"> -->
 <!-- <img src="{% static 'img/Roblox-md-2.jpeg' %}"> -->
            <!-- </div> -->
        </div>

    </div>

    <div class="disclaimer py-5">
        <div class="row">
            <div class="col-12">
                <p>DISCLAIMER</p>
        
                  <p>This website is for informational purposes only and is a paid legal advertisement. It does not constitute legal advice, nor does it create an attorney-client relationship. While we strive for accuracy, we cannot guarantee the completeness of the information provided. Always consult a licensed attorney for guidance on your specific legal situation. This website also does not offer medical advice; consult a physician before changing any medical regimen. We are not liable for actions taken based on the information presented here. Our mission is to help you access information that supports your rights.</p>
                     <p class="pt-2"> © 2024 All rights reserved.</p>
            </div>
        </div>
        
        

    </div>
    <footer class="footer text-secondary">
        <div class="d-block d-md-flex justify-content-between align-items-center ">

            <div><a href="privacyandpolicy.html" class="text-secondary ">Privacy Policy </a>| <a href="termsandcondition.html" class="text-secondary">Terms & Conditions</a></div>
            <div class="d-flex align-items-center gap-1">
                follow us on:
                <a href="#" target="_blank" class="text-secondary"><img src="{% static 'img/facebook.jpg' %}" /> </a> |
                <a href="#" target="_blank" class="text-secondary"><img src="{% static 'img/insta.jpg' %}" /> </a>
            </div>
        </div>
        
    </footer>


    <!-- modal popup code -->
      <div class="modal-overlay" id="modal">
        <div class="modal-content scroll">
          <div class="row justify-content-end">
            <div class="col-11"></div>
             <button class="col-12 close-modal" onclick="closeModal()">&times;</button>
            </div>
            <!-- Screen 1 -->
            <div class="form-screen active px-3" id="screen1">
               <div class="input-group">
                    <label>What best describes the troubling actions?</label>
                    <select id="question_3" class="question-dropdown" data-question-text="What best describes the troubling actions?"></select>
                </div>

                <div class="input-group">
                    <label>Did the child and predator first meet on Roblox?</label>
                    <select id="question_4" class="question-dropdown" data-question-text="Did the child and predator first meet on Roblox?"></select>
                </div>

                 <div class="form-footer">
                    <button type="button" class="btn-primary" onclick="showScreen(2)">Next</button>
                </div>
            </div>

            <!-- Screen 2 -->
           <div class="form-screen px-3" id="screen2"> 
            <div class="input-group">
                <label>First Name:</label>
                <input type="text" id="first_name" required>
            </div>
            <div class="input-group">
                <label>Last Name:</label>
                <input type="text" id="last_name" required>
            </div>
            <div class="input-group">
                <label>Cell Phone:</label>
                <input type="tel" id="cell_phone" required>
            </div>
            <div class="input-group">
                <label>Email:</label>
                <input type="email" id="email" required>
            </div>
            <div class="input-group">
                <label>Zip Code:</label>
                <input type="text" id="zipcode" required>
            </div>
            <div class="input-group">
                <label>Are you currently working with an attorney for this case?</label>
                <select id="working_with_attorney" required>
                    <option value="">Select</option>
                    <option value="yes">Yes</option>
                    <option value="no">No</option>
                </select>
            </div>
            <div class="input-group d-flex">
                <div class="d-flex align-items-end gap-1">
                    <input type="checkbox" id="consent_checkbox" class="check-bx">
                    <label style="font-size: 11px;" class="">
                        By selecting Submit and completing this form I confirm that I am over 18...
                    </label>
                </div>
            </div>
            <div class="form-footer">
                <button type="button" class="btn-secondary" onclick="showScreen(1)">Back</button>
                <button type="button" class="btn-primary" onclick="submitForm()">Submit</button>
            </div>
</div>

        </div>
        <input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}">

        <!-- <form style="display: none;">
            {% csrf_token %}
        </form> -->
    </div>

    <!-- modal popup end -->

 <script>
    // Read CSRF token from the meta tag and add it to every AJAX request
    function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            // Does this cookie string begin with the name we want?
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}

    
    const csrftoken = getCookie('csrftoken');

    $.ajaxSetup({
        beforeSend: function(xhr, settings) {
            if (!(/^http:.*/.test(settings.url) || /^https:.*/.test(settings.url))) {
                xhr.setRequestHeader("X-CSRFToken", csrftoken);
            }
        }
    });


    function closeModal() {
        document.getElementById('modal').style.display = 'none';
    }

    document.getElementById('openModal').addEventListener('click', () => {
        document.getElementById('modal').style.display = 'block';
    });

    function showScreen(screenNumber) {
        document.querySelectorAll('.form-screen').forEach(screen => {
            screen.classList.remove('active');
        });
        document.getElementById(`screen${screenNumber}`).classList.add('active');
    }

    
    function submitForm() {
    const first_name = $("#first_name").val().trim();
    const last_name = $("#last_name").val().trim();
    const cell_phone = $("#cell_phone").val().trim();
    const email = $("#email").val().trim();
    const zipcode = $("#zipcode").val().trim();
    const working_with_attorney = $("#working_with_attorney").val();
    const consent = $("#consent_checkbox").is(":checked");

    if (!first_name || !last_name || !cell_phone || !email || !zipcode || !working_with_attorney) {
        alert("Please fill all required fields.");
        return;
    }

    if (!consent) {
        alert("You must agree to the terms before submitting.");
        return;
    }

    const redirectUrl = "intake-form/";

    // ✅ Step 1: Submit user details
    $.ajax({
        url: "/api/user-details/",
        type: "POST",
        contentType: "application/json",
        data: JSON.stringify({
            first_name,
            last_name,
            cell_phone,
            email,
            zipcode,
            working_with_attorney
        }),
        success: function (response) {
            const userId = response.id;

            // ✅ Step 2: Store first/last name for prepopulation
            sessionStorage.setItem("guardian_first_name", first_name);
            sessionStorage.setItem("guardian_last_name", last_name);

            // ✅ Step 3: Send thank you email
            const emailFormData = new FormData();
            emailFormData.append("from_email", "kumaranyuvaraj007@gmail.com");
            emailFormData.append("to_email", email);
            emailFormData.append("subject", "Thank you for your submission");
            emailFormData.append("body", `Hi ${first_name},\n\nThank you for submitting your details. We’ll review and get back to you shortly.\n\nRegards,\nSupport Team`);

            $.ajax({
                url: "/send-email/",
                type: "POST",
                data: emailFormData,
                processData: false,
                contentType: false,
                success: function () {
                    // ✅ Step 4: Submit additional answers (if needed)
                    submitAnswers(userId, function () {
                        const confirmed = confirm("Your details have been submitted. Do you want to proceed to the Intake Form?");
                        if (confirmed) {
                            window.location.href = redirectUrl;
                        }
                    });
                },
                error: function (xhr) {
                    const err = xhr.responseJSON?.error || "Error sending confirmation email.";
                    alert("Submission succeeded but email failed: " + err);
                }
            });
        },
        error: function (xhr) {
            console.error(xhr.responseJSON);
            alert("Error submitting the form.");
        }
    });
}


    // $("#userForm")[0].reset();
let questionsData = [];

$(document).ready(function () {
    $.ajax({
        url: "/api/questions/",
        type: "GET",
        success: function (response) {
            questionsData = response;

            $(".question-dropdown").each(function () {
                const $select = $(this);
                const questionText = $select.data("question-text").trim();

                const matchingQuestion = response.find(q => q.text.trim() === questionText);

                if (matchingQuestion) {
                    $select.attr("data-question-id", matchingQuestion.id);
                    $select.append(`<option value="">-- Select --</option>`);

                    matchingQuestion.options.forEach(opt => {
                        $select.append(`<option value="${opt.id}">${opt.text}</option>`);
                    });
                } else {
                    console.warn(`No matching question found for: ${questionText}`);
                }
            });
        },
        error: function () {
            alert("Failed to load questions.");
        }
    });
});




    function submitAnswers(userId, callback) {
    const promises = [];

    $(".question-dropdown").each(function () {
        const $select = $(this);
        const questionId = $select.data("question-id");
        const selectedOptionId = $select.val();

        if (!selectedOptionId || !questionId) return;

        const promise = $.ajax({
            url: "/api/answers/submit/",
            type: "POST",
            contentType: "application/json",
            headers: {
                "X-CSRFToken": getCookie("csrftoken"),
            },
            data: JSON.stringify({
                user: userId,
                question: questionId,
                selected_option: selectedOptionId
            }),
            success: function () {
                console.log(`Answer submitted for Question ID ${questionId}`);
            },
            error: function (xhr) {
                console.error(`Failed to submit answer for Question ID ${questionId}:`, xhr.responseJSON);
            }
        });

        promises.push(promise);
    });

    // ✅ Wait for all answer submissions to complete, then call callback
    $.when(...promises).done(function () {
        if (typeof callback === "function") {
            callback();  // Now we redirect
        }
    });
}

    </script>

    </body>
</html>


<!-- <button id="openModal" class="btn-primary">Yes</button> -->

   

   